The gym at Tufts can often be very very full; every treadmill is taken, every rack is occupied, the stretching mats are completely covered, etc. It can be highly inconvenient for students to carefully plan one's day, just to arrive at the gym and waste time (or be unable to workout at all) waiting around for a rack to open up. We wanted to create a website that would conveniently display the current capacity of the weight room, and analyze trends in capacity over time, such that a student can see business-levels ahead of time and plan accordingly.

To implement our solution, we used two Raspberry Pi Zero's and two MaxBotix MaxSonar-EZ1's. The sonar sensors can detect distance of objects up to 11' away with +/- 4cm accuracy. The Raspberry Pi's continually read sonar data and run a linear regression function on arrays of distances. If a person is approaching the door, above which the sensing system is placed, the sonar sensors will return decreasing distane values. This means if the Raspberry Pi's return a negative slope with an appropriate r^2 value, a person is walking towards/away the gym door. If a person is walking in, the Raspberry Pi sends "+1" to a web server which gets logged in a MongoDB database ("-1" for a person walking out). When a client requests to see the html page, the server loads in the appropriate live data, updates html, and sends the web app. The Pi's were configured to automatically connect to wifi and collect/send data on boot, when one simply plugs them in. A complete system diagram can be seen in the slide deck. Many libraries were used to write the algorithms on both the server and client sides. A detailed summary of hardware and libraries used can also be found in the slides.

A 12 NeoPixel ring was utilized for error notices. When the Pi turns on, a power sequence is executed and then one neopixel turns (and remains) green to indicate power and that the rc.local script is running. Once the algorithm starts and a wifi connection is established, the blue neopixel turns on. Once the blue and green neopixels are on, the system is ready and should be operating properly. The power sequence can be seen in the uploaded .mov file. The entire process from plug-in to running the algorithim with wifi takes about 1 minute and 30 seconds to 2 minutes.

If you'd like to implement this project yourself, I've uploaded the final Raspberry Pi disk image which contains all of the necessary libraries, dependencies, algorithms, and boot configurations to run this gym monitor app. PLEASE NOTE: flash the disk image onto two Raspberry Pi's. On one, change the "+1" sent to the database to "-1" then remember which pi sends what increment. Be careful when flashing the disk image, I ran into Kernel Panic errors when I initially tried to clone and copy the image. I recommend using a USB micro sd reader on a Pi already running Raspbian such that you can use the internal "SD Card Copier" application, and not Win32 or Etcher. Also, make sure you configure your own personal wireless settings.

This project was developed for Ming Chow's Spring 2018 Comp20 Final Semester Group Project at Tufts University. Myself, Robert Yang, Peter Lam, and Benson Cheng worked together to create a functional platform for tracking the Tufts gym capacity. 

Here is the live url for our gym monitoring app: https://tufts-gym-monitor.herokuapp.com/
